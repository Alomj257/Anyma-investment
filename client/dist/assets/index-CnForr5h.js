import{r,j as t,g as Z,u as G}from"./index---ThxQHl.js";import{D as H}from"./index-DcRcC6kR.js";import{r as K}from"./right_arrow-CHTTzB5r.js";import{g as L}from"./companyService-BBubZftP.js";import{c as M,a as Y,b as Q}from"./dateTimeFormater-DxVYPYlX.js";import{S as tt}from"./index-naFqRyV3.js";import{c as B}from"./Frame-BNJlJ0X3.js";import{n as $,a as U,b as et}from"./investorGrossTotal-S4L9jiCN.js";import"./index-C_7aPAX4.js";import"./iconBase-BwtrK68j.js";const st="/assets/investment-DZaxrG47.png",nt="/assets/examination-DLEo242M.png",at="/assets/receive-money-BX_SY2uW.png",rt="/assets/distribution-of-wealth-BkfwJAiH.png",it="/assets/increase-BlPrZrvo.png",ot="/assets/return-on-investment-hb7KJEPm.png",ct=({deals:c,sector:z,currentValuation:I,userId:l})=>{var S,v;const[p,s]=r.useState(0),[u,C]=r.useState(0),[D,F]=r.useState(0),[g,R]=r.useState(0),b=async()=>{const d=(await Y(l)).reduce((N,f)=>{var j;const x=(j=f==null?void 0:f.investors)==null?void 0:j.find(e=>e.investerId===l);return N+parseInt((x==null?void 0:x.amount)||0)},0);F(d)};return r.useEffect(()=>{const T=async()=>{var h;let d=0,N=0,f=0,x=[],j=0;for(const n of c){const a=(h=n==null?void 0:n.investors)==null?void 0:h.find(i=>i.investerId===l);if(a){f+=1;const i=parseFloat((a==null?void 0:a.amount)||0)+parseFloat((a==null?void 0:a.fees)||0),y=parseFloat((a==null?void 0:a.carried)||0),w=parseFloat((a==null?void 0:a.shareholding)||0),P=await $(i,w,I,n.currency,y/100),q=await U(i,w,I,n.currency,y/100);j+=i,x=[...x,[-1*i,n==null?void 0:n.investedDate]],d+=P,N+=q}}x=[...x,[j+d,new Date]];const e=B(x);R(e==null?void 0:e.toFixed(2)),s(d.toFixed(2)),C(N/f)};b().then(()=>T())},[I,l,c]),t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("button",{className:`btn btn-sm text-dark text-nowrap bg-white-smoke
                ${Number.isNaN(p)?"bg-white-smoke text-dark":p<0?"loss":"profit"}`,children:"NET PROFIT"}),t.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{marginTop:"10%"},children:t.jsx("div",{className:"fw-bold p-txt",style:{textAlign:"center",fontSize:"13px",color:p.toString()=="NaN"?"black":p<0?"red":"green"},children:M(p)})})]}),t.jsxs("div",{children:[t.jsx("button",{className:`btn btn-sm text-dark text-nowrap bg-white-smoke
                ${Number.isNaN(u)?"bg-white-smoke text-dark":u<0?"loss":"profit"}`,children:"NET MOIC"}),t.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{marginTop:"10%"},children:t.jsx("div",{className:"fw-bold p-txt",style:{textAlign:"center",fontSize:"13px",color:u.toString()=="NaN"?"black":u<0?"red":"green"},children:u&&((S=u==null?void 0:u.toString())==null?void 0:S.substring(0,4))+"x"})})]}),t.jsxs("div",{children:[t.jsx("button",{className:`btn btn-sm text-dark text-nowrap bg-white-smoke
                ${Number.isNaN(g)?"bg-white-smoke text-dark":g<0?"loss":"profit"}`,children:"NET IRR"}),t.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{marginTop:"10%"},children:t.jsx("div",{className:"fw-bold p-txt",style:{textAlign:"center",fontSize:"13px",color:g.toString()=="NaN"?"black":g<0?"red":"green"},children:g&&((v=g.toString())==null?void 0:v.substring(0,4))+"%"})})]})]})},bt=()=>{var f,x,j;r.useState(!1);const[c,z]=r.useState([]),[I,l]=r.useState(0),[p,s]=r.useState(0),[u,C]=r.useState(0),[D,F]=r.useState(1),[g,R]=r.useState(0),[b,S]=r.useState(0),[v,T]=r.useState(0),d=(x=(f=Z())==null?void 0:f.user)==null?void 0:x._id,N=[{name:" TOTAL INVESTMENTS",qty:I,icon:st},{name:"   AMOUNT INVESTED (INCL. FEES)",qty:M(p),icon:at},{name:"CURRENT VALUE OF INVESTMENT",qty:M(u),icon:nt},{name:" NET PROFIT (LOSS)",qty:(g<0?"(-) ":"")+M(Math.abs(g)),icon:it},{name:"  NET MOIC",qty:b&&((j=b==null?void 0:b.toString())==null?void 0:j.substring(0,4))+"x"||0,icon:rt},{name:"  NET IRR",qty:v+"%",icon:ot}];return r.useEffect(()=>{(async()=>{var P,q,V;const h=await Q(d);let n=0,a=0,i=0,y=0,w=[];for(const k of h)for(const o of k==null?void 0:k.deals){const W=await et(o==null?void 0:o.currency);F(W);const E=await L(o==null?void 0:o.companyId),m=(P=o==null?void 0:o.investors)==null?void 0:P.find(A=>A.investerId===d);if(m){y+=1;const A=parseFloat((m==null?void 0:m.amount)||0)+parseFloat((m==null?void 0:m.fees)||0),O=parseFloat((m==null?void 0:m.carried)||0),_=parseFloat((m==null?void 0:m.shareholding)||0),J=await $(A,_,parseInt(((q=E==null?void 0:E.dealSummary)==null?void 0:q.currentValuation)||0),o.currency,O/100),X=await U(A,_,parseInt(((V=E==null?void 0:E.dealSummary)==null?void 0:V.currentValuation)||0),o.currency,O/100);n+=J,a+=X,i+=A,w=[...w,[-1*A,o==null?void 0:o.investedDate]]}}if(i!==0){w=[...w,[i+n,new Date]];const k=B(w);T(k==null?void 0:k.toFixed(2))}R(n),S(a/y),s(i),C(i+n),z(h),l(y)})()},[d]),t.jsx(t.Fragment,{children:t.jsxs("div",{className:"main-part",children:[t.jsx("div",{className:"my-3",children:t.jsx("div",{className:"bg-dark py-3 px-4 rounded d-flex justify-content-between",children:t.jsx("h5",{className:"text-white mb-0 fw-bold text-capitalize",children:"Overview"})})}),t.jsx("div",{className:"overview",children:t.jsx("div",{className:"container w-100 pe-0",children:t.jsx("div",{className:"row",children:t.jsx("div",{className:"row row-cols-3 pe-0",children:N==null?void 0:N.map((e,h)=>{var n;return t.jsx("div",{className:"px-0 ",children:t.jsxs("div",{className:`d-flex px-4 py-2 border border-1 box mb-3 over-box ${h%3!==0&&"mx-3 me-0"} rounded-3 border-dark bg-white justify-content-between`,children:[t.jsxs("div",{className:"d-flex flex-column justify-content-between",children:[t.jsx("span",{className:"text-muted small fw-bold",style:{fontSize:"12px"},children:e==null?void 0:e.name}),t.jsx("span",{className:"fw-bold p-txt fs-5",style:{fontSize:"13px"},children:((n=e==null?void 0:e.qty)==null?void 0:n.length)>20?`${e==null?void 0:e.qty.slice(0,15)}....`:e==null?void 0:e.qty})]}),t.jsx("div",{className:"my-auto rounded-circle bg-very-light-red",style:{width:"50px",aspectRatio:"1/1"},children:t.jsx("img",{className:"w-200 h-100 p-3",src:e==null?void 0:e.icon,alt:""})})]})},h)})})})})}),t.jsxs("div",{className:"h-50",children:[t.jsx("div",{className:"my-3",children:t.jsx("div",{className:"bg-dark py-3 px-4 rounded d-flex justify-content-between",children:t.jsx("h5",{className:"text-white mb-0 fw-bold text-capitalize",children:"Investments"})})}),t.jsx("div",{className:"w-100",children:c&&c.length>0&&(c==null?void 0:c.map((e,h)=>t.jsx(lt,{list:c,index:h,companyId:e==null?void 0:e._id,userId:d,deals:e==null?void 0:e.deals})))})]})]})})},lt=({companyId:c,list:z,index:I,deals:l,userId:p})=>{var b,S,v,T,d,N,f;const[s,u]=r.useState(null),[C,D]=r.useState(!1),[F,g]=r.useState(0);r.useState(0);const R=G();return r.useEffect(()=>{(async()=>{const j=await L(c);u(j),g(()=>l.reduce((h,n)=>{var i;const a=(i=n==null?void 0:n.investors)==null?void 0:i.find(y=>y.investerId===p);return h+parseFloat((a==null?void 0:a.amount)||0)},0))})()},[c]),t.jsx(t.Fragment,{children:t.jsxs("div",{className:"investment_container_table",children:[t.jsxs("div",{className:"investment_container",children:[t.jsx("div",{onClick:()=>R("/customer/overview/about",{state:c}),className:"invt_img",style:{display:"flex",justifyContent:"center",cursor:"pointer",alignItems:"center",padding:"10px"},children:t.jsx("img",{src:tt+(s==null?void 0:s.profile)||(s==null?void 0:s.img),style:{width:"98%",maxWidth:"150px",padding:"5px"},alt:""})}),t.jsxs("div",{className:"invt_ftq",children:[t.jsxs("div",{children:[t.jsx("button",{className:"btn btn-sm bg-white-smoke text-dark text-nowrap",children:"ASSET CLASS"}),t.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{marginTop:"10%"},children:t.jsx("div",{className:"fw-bold p-txt",style:{textAlign:"center",fontSize:"13px"},children:(b=s==null?void 0:s.dealSummary)==null?void 0:b.asset})})]}),t.jsxs("div",{children:[t.jsx("button",{className:"btn btn-sm bg-white-smoke text-dark text-nowrap",children:"SECTOR"}),t.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{marginTop:"14%"},children:t.jsx("div",{className:"fw-bold p-txt",style:{textAlign:"center",fontSize:"13px"},children:((v=(S=s==null?void 0:s.dealSummary)==null?void 0:S.sector)==null?void 0:v.length)>8?`${(T=s==null?void 0:s.dealSummary)==null?void 0:T.sector.slice(0,8)}...`:(d=s==null?void 0:s.dealSummary)==null?void 0:d.sector})})]}),t.jsxs("div",{children:[t.jsx("button",{className:"btn btn-sm text-dark text-nowrap bg-white-smoke",children:"INVESTMENT"}),t.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{marginTop:"10%"},children:t.jsx("div",{className:"fw-bold p-txt",style:{textAlign:"center",fontSize:"13px"},children:M(F)})})]})]}),t.jsx("div",{className:"invt_stq",children:t.jsx(ct,{deals:l,userId:p,currentValuation:(N=s==null?void 0:s.dealSummary)==null?void 0:N.currentValuation,sector:(f=s==null?void 0:s.dealSummary)==null?void 0:f.sector})}),t.jsxs("div",{className:"invt_ltq",children:[t.jsxs("div",{children:[t.jsx("button",{className:"btn btn-sm bg-white-smoke text-dark text-nowrap",children:"Weight"}),t.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{marginTop:"10%"},children:t.jsx("div",{className:"fw-bold p-txt",style:{textAlign:"center",fontSize:"13px"},children:"---"})})]}),t.jsxs("div",{children:[t.jsxs("button",{className:"btn btn-sm text-dark text-nowrap bg-white-smoke loss",style:{cursor:"pointer"},onClick:()=>D(!0),children:["NÂ° of INV.",t.jsx("img",{src:K,alt:"Right Arrow"})]}),t.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{marginTop:"10%"},children:t.jsx("div",{className:"fw-bold p-txt",style:{textAlign:"center",fontSize:"13px",color:"red"},children:l==null?void 0:l.length})})]})]})]}),C&&t.jsx(H,{userId:p,company:s,deals:l,setIsNew:D})]})})};export{bt as default};
