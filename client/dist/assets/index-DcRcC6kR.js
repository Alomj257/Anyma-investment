import{r as g,j as t,u as _,g as T}from"./index---ThxQHl.js";import{B as A}from"./index-C_7aPAX4.js";import{S as P}from"./index-naFqRyV3.js";import{a as R,b as D,c as I}from"./dateTimeFormater-DxVYPYlX.js";import{n as M,a as W}from"./investorGrossTotal-S4L9jiCN.js";import{c as z,f as B}from"./Frame-BNJlJ0X3.js";const C=({deal:r,sector:s,currentValuation:i,userId:n})=>{var b;const[d,o]=g.useState(0),[a,e]=g.useState(0),[f,j]=g.useState(0),[x,N]=g.useState(0);return g.useEffect(()=>{(async()=>{const m=(await R(n)).reduce((h,l)=>{var u;const p=(u=l==null?void 0:l.investors)==null?void 0:u.find(S=>S.investerId===n);return h+parseInt((p==null?void 0:p.amount)||0,10)},0);j(m)})()},[n]),g.useEffect(()=>{r&&i&&(async()=>{var l;const c=(l=r==null?void 0:r.investors)==null?void 0:l.find(p=>p.investerId===n);let m=0,h=[];if(c){const p=parseFloat((c==null?void 0:c.amount)||0)+parseFloat((c==null?void 0:c.fees)||0),u=parseFloat((c==null?void 0:c.carried)||0),S=parseFloat((c==null?void 0:c.shareholding)||0),E=await M(p,S,i,r.currency,u/100),F=await W(p,S,i,r.currency,u/100);m+=p,h=[...h,[-1*p,r==null?void 0:r.investedDate]],h=[...h,[m+E,new Date]];const k=z(h);N(k==null?void 0:k.toFixed(2)),o(E.toFixed(2)),e(F)}})()},[i,n,r,f]),t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"table_cell",style:{color:d.toString()=="NaN"?"black":d<0?"red":"green",fontSize:"12px"},children:d}),t.jsx("td",{className:"table_cell",style:{color:a.toString()=="NaN"?"black":a<0?"red":"green",fontSize:"12px"},children:a&&((b=a==null?void 0:a.toString())==null?void 0:b.substring(0,4))+"x"}),t.jsx("td",{className:"table_cell",style:{color:x.toString()==="NaN"?"black":x<0?"red":"green",fontSize:"12px"},children:(x==null?void 0:x.length)>10?`${x.slice(0,10)}...%`:x+"%"})]})},O=async(r,s)=>{var i;try{const n=await D(r);let d=0;for(const o of n)for(const a of o==null?void 0:o.deals){const e=(i=a==null?void 0:a.investors)==null?void 0:i.find(f=>f.investerId===r);if(e){const f=parseFloat((e==null?void 0:e.amount)||0);d+=f}}return console.log(s,d),(s/d*100).toFixed(2)}catch(n){return console.log(n),0}},q=({setIsNew:r,company:s,deals:i,userId:n})=>{var a;const d=_(),o=(a=T())==null?void 0:a.user;return t.jsx("div",{className:"pop",children:t.jsxs("div",{className:"pop-body col-md-8",children:[t.jsx("div",{className:"text-end",children:t.jsx(A,{onClick:()=>r(e=>!e),className:"cursor-pointer",size:25})}),t.jsxs("div",{className:"img_table_container",children:[t.jsx("div",{className:"invt_img",onClick:()=>d("about",{state:s==null?void 0:s._id}),children:t.jsx("img",{className:"w-100 h-100 rounded-circle cursor-pointer",src:s!=null&&s.profile?P+(s==null?void 0:s.profile):B,alt:"Profile_img",style:{maxWidth:"100px",maxHeight:"100px"}})}),t.jsxs("table",{children:[t.jsx("thead",{className:"thead-dark",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col text-uppercase ",style:{aspectRatio:"1/1"},className:"border-0",children:" "}),t.jsx("th",{scope:"col text-uppercase",children:t.jsx("button",{className:"btn btn-sm bg-white-smoke text-dark text-nowrap header-spacing",children:"INVESTMENT DATE"})}),t.jsx("th",{scope:"col text-uppercase ",children:t.jsx("button",{className:"btn btn-sm bg-white-smoke text-dark text-nowrap header-spacing",children:"INVESTMENT"})}),t.jsx("th",{scope:"col text-uppercase ",children:t.jsx("button",{className:"btn btn-sm bg-white-smoke text-dark text-nowrap header-spacing",children:"NET PROFIT(LOSS)"})}),t.jsx("th",{scope:"col text-uppercase ",children:t.jsx("button",{className:"btn btn-sm bg-white-smoke text-dark text-nowrap header-spacing",children:"NET MOIC"})}),t.jsx("th",{scope:"col text-uppercase ",children:t.jsx("button",{className:"btn btn-sm bg-white-smoke text-dark text-nowrap header-spacing",children:"NET IRR"})}),t.jsx("th",{scope:"col text-uppercase ",children:t.jsx("button",{className:"btn btn-sm bg-white-smoke text-dark text-nowrap header-spacing",children:"WEIGHT"})}),t.jsx("th",{style:{width:"60px",aspectRatio:"1/1"},className:"border-0"})]})}),t.jsx("tbody",{children:i==null?void 0:i.map((e,f)=>{var j,x,N,b,w,c,m,h;return t.jsxs("tr",{children:[t.jsx("td",{}),t.jsx("td",{className:"table_cell",children:e==null?void 0:e.investedDate}),t.jsx("td",{className:"table_cell",children:I((e==null?void 0:e.investors)&&((x=(j=e==null?void 0:e.investors)==null?void 0:j.find(l=>l.investerId===(o==null?void 0:o._id)))==null?void 0:x.amount)||(e==null?void 0:e.investors)&&((b=(N=e==null?void 0:e.investors)==null?void 0:N.find(l=>l.investerId===n))==null?void 0:b.amount))}),t.jsx(C,{deal:e,currentValuation:(w=s==null?void 0:s.dealSummary)==null?void 0:w.currentValuation,userId:n||(o==null?void 0:o._id),sector:(c=s==null?void 0:s.dealSummary)==null?void 0:c.sector}),t.jsx("td",{className:"table_cell",children:t.jsx(G,{userId:n,amount:(e==null?void 0:e.investors)&&((h=(m=e==null?void 0:e.investors)==null?void 0:m.find(l=>l.investerId===n))==null?void 0:h.amount)})})]},f)})})]})]})]})})},G=({userId:r,amount:s})=>{const[i,n]=g.useState(0);return g.useEffect(()=>{(async()=>{const o=await O(r,parseFloat(s||0));console.log(r,s,o),n(o)})()},[r,s]),t.jsxs(t.Fragment,{children:[i,"% "]})};export{q as D};
