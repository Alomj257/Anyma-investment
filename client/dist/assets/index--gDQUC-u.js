import{r as i,j as e,u as P,g as v,a as L}from"./index-Bzji-wxz.js";import{g as k,u as B,r as O}from"./AuthService-C590zoJ2.js";import{c as R,a as z,b as U}from"./dateTimeFormater-DhAauVPG.js";import{g as V}from"./companyService-BiK0zN2j.js";import{D as _}from"./index-BQ0gfMTN.js";import{S as G}from"./index-Br0LXuIA.js";import{I as X}from"./index-cesghhsW.js";import{n as Y,a as q}from"./investorGrossTotal-DxoXMrVw.js";import{c as H}from"./Frame-BNJlJ0X3.js";import"./index-C6CzEBkJ.js";import"./iconBase-ImsQrOpS.js";function J(l=8){const d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="";const t=d.length;for(let c=0;c<l;c++)a+=d.charAt(Math.floor(Math.random()*t));return a}const K=({deals:l,sector:d,currentValuation:a,userId:t})=>{var f;const[c,s]=i.useState(0),[h,N]=i.useState(0),[w,I]=i.useState(0),[y,n]=i.useState(0),r=async()=>{const x=(await z(t)).reduce((E,u)=>{var b;const m=(b=u==null?void 0:u.investors)==null?void 0:b.find(g=>g.investerId===t);return E+parseInt((m==null?void 0:m.amount)||0)},0);I(x)};return i.useEffect(()=>{const C=async()=>{var S;let x=0,E=0,u=0,m=[],b=0;for(const p of l){const o=(S=p==null?void 0:p.investors)==null?void 0:S.find(j=>j.investerId===t);if(o){u+=1;const j=parseFloat((o==null?void 0:o.amount)||0)+parseFloat((o==null?void 0:o.fees)||0),M=parseFloat((o==null?void 0:o.carried)||0),T=parseFloat((o==null?void 0:o.shareholding)||0),A=await Y(j,T,a,p.currency,M/100),D=await q(j,T,a,p.currency,M/100);b+=j,m=[...m,[-1*j,p==null?void 0:p.investedDate]],x+=A,E+=D}}m=[...m,[b+x,new Date]];const g=H(m);n(g==null?void 0:g.toFixed(2)),s(x.toFixed(2)),N(E/u)};r().then(()=>C())},[a,t,l]),e.jsxs(e.Fragment,{children:[e.jsx("td",{children:R(c)}),e.jsx("td",{children:d}),e.jsx("td",{children:h&&((f=h==null?void 0:h.toString())==null?void 0:f.substring(0,4))+"x"}),e.jsx("td",{children:y+"%"})]})},Q=({userId:l})=>{const[d,a]=i.useState([]);return i.useEffect(()=>{(async()=>{const c=await U(l);a(c)})()},[]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"bg-white h-50 ",children:e.jsxs("table",{className:"p-3",children:[e.jsx("thead",{className:"thead-dark",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col text-uppercase ",style:{aspectRatio:"1/1"},className:"border-0",children:" "}),e.jsx("th",{scope:"col text-uppercase ",children:" COMPANY"}),e.jsx("th",{scope:"col text-uppercase ",children:"ASSET CLASS"}),e.jsx("th",{scope:"col text-uppercase ",children:"TOTAL INVESTMENT"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET PROFIT(LOSS)"}),e.jsx("th",{scope:"col text-uppercase ",children:"SECTOR"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET MOIC"}),e.jsx("th",{scope:"col text-uppercase ",children:"NET IRR "}),e.jsx("th",{scope:"col text-uppercase ",className:"text-end",children:"NUMBER OF INVESTMENTS "}),e.jsx("th",{style:{aspectRatio:"1/1"},className:"border-0"})]})}),e.jsxs("tbody",{children:[d.length==0&&e.jsx("h5",{className:"text-center text-muted",children:"No Any Investment  "}),d.length>0&&(d==null?void 0:d.map((t,c)=>e.jsx(W,{list:d,index:c,companyId:t==null?void 0:t._id,userId:l,deals:t==null?void 0:t.deals})))]})]})})})},W=({companyId:l,list:d,index:a,deals:t,userId:c})=>{var C,x;const[s,h]=i.useState({}),[N,w]=i.useState(!1),[I,y]=i.useState(0),[n,r]=i.useState(0);i.useState(0);const f=P();return i.useEffect(()=>{(async()=>{var m;const u=await V(l);h(u),r((m=u==null?void 0:u.dealSummary)==null?void 0:m.currentValuation),y(()=>t.reduce((g,S)=>{var o;const p=(o=S==null?void 0:S.investors)==null?void 0:o.find(j=>j.investerId===c);return g+parseInt((p==null?void 0:p.amount)||0)},0))})()},[l,t]),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"p-3 ",children:[e.jsx("td",{children:e.jsxs("div",{className:"ms-2 cursor-pointer",onClick:()=>f("/admin/companies/new-company",{state:s==null?void 0:s._id}),style:{aspectRatio:"1/1"},children:["  ",e.jsx("img",{className:"w-100 h-100 rounded-circle",src:G+(s==null?void 0:s.profile)||(s==null?void 0:s.img),alt:""})]})}),e.jsx("td",{className:"text-capitalize cursor-pointer",onClick:()=>f("/admin/companies/new-company",{state:s==null?void 0:s._id}),children:s==null?void 0:s.name}),e.jsx("td",{children:(C=s==null?void 0:s.dealSummary)==null?void 0:C.asset}),e.jsx("td",{children:R(I)}),e.jsx(K,{deals:t,userId:c,currentValuation:n,sector:(x=s==null?void 0:s.dealSummary)==null?void 0:x.sector}),e.jsx("td",{className:"pe-4",children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsxs("button",{onClick:()=>w(!0),className:"btn-dark d-flex justify-content-center gap-2 align-items-center",children:[t&&(t==null?void 0:t.length)," ",e.jsxs("div",{style:{width:"20px",aspectRatio:"1/1"},className:" rounded-circle bg-dark-orange",children:[" ",e.jsx(X,{size:10})]})]})})})]},a),N&&e.jsx(_,{userId:c,company:s,deals:t,setIsNew:w})]})},le=()=>{var y;const l=(y=v())==null?void 0:y.user,{pathname:d,state:a}=L(),t=d.split("/"),[c,s]=i.useState(null),[h,N]=i.useState(!1),w=n=>{const{name:r,value:f}=n.target;s({...c,[r]:f})};i.useEffect(()=>{a&&(async()=>{const r=await k(a);s({...r==null?void 0:r.account,...r==null?void 0:r.personal})})()},[a]);const I=n=>{if(n.preventDefault(),a){B(a,{personal:{...c},account:{...c}}),N(!1);return}const r=J();O({member:{adminId:l==null?void 0:l._id},account:{...c,password:r,cnfPassword:r},personal:{...c}})};return e.jsxs(e.Fragment,{children:[a&&e.jsxs("div",{className:"d-flex my-3 py-2  admin-header justify-content-between align-items-center",children:[e.jsx("h5",{className:"text-capitalize m-0 fw-semibold",children:"Personal Details"}),e.jsx("div",{className:"right-profile  d-flex gap-4",children:!h&&e.jsx("div",{children:e.jsx("button",{onClick:()=>N(!0),className:"btn-red py-2 text-decoration-none",children:"Edit"})})})]}),e.jsxs("form",{action:"",onSubmit:I,children:[e.jsx("div",{className:"bg-white create-mamber",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"row row-cols-3",children:F==null?void 0:F.map((n,r)=>e.jsx("div",{children:e.jsxs("div",{className:"mx-3 mb-3 d-flex flex-column gap-2 field",children:[e.jsx("label",{className:"ms-3",htmlFor:"",children:n==null?void 0:n.label}),e.jsx("input",{type:(n==null?void 0:n.type)==="date"?"date":"text",style:{cursor:a?h?"auto":"not-allowed":"auto"},disabled:a?!h:!1,onChange:w,value:c&&c[n==null?void 0:n.name],name:n==null?void 0:n.name,className:"input-field"})]})},r))})})})}),(h||!a)&&e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"btn-red rounded-5 px-4 my-3",children:"Save"})})]}),!(t!=null&&t.includes("personal-add"))&&e.jsxs("div",{className:"h-50 investment-table",children:[e.jsx("div",{className:"my-3",children:e.jsx("div",{className:"bg-dark py-3 px-4 rounded d-flex justify-content-between",children:e.jsx("h5",{className:"text-white mb-0 fw-bold",children:"Investments"})})}),e.jsx(Q,{userId:a})]})]})},F=[{place:"Thomas",type:"input",name:"firstName",label:"First name"},{place:"Domingue",type:"input",name:"lastName",label:"Last name"},{place:"thomas.domnugue@gmail.com",type:"input",name:"email",label:" E-mail"},{place:"Paris, France",type:"input",name:"city",label:"City of residence"},{place:" 10-05-1993",type:"date",name:"dob",label:"Date Of birth"},{place:" 07754838908",type:"input",name:"phone",label:"Phone number"},{place:"Blue Nest",type:"input",name:"company",label:"Company name"},{place:" Tech and E-commerce ",type:"input",name:"industry",label:" Industry"}];export{le as default};
